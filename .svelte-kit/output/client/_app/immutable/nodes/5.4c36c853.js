import{S as Q,i as W,s as X,k as v,y as Y,a as C,q as j,l as b,m as w,z as Z,c as O,r as q,h as a,n as i,b as T,A as $,G as y,u as P,O as x,g as tt,d as et,B as st,o as lt,e as N,U as rt,V as it,R,H as at,p as ot}from"../chunks/index.e9c46f01.js";import{C as ut}from"../chunks/Clock.34340839.js";async function ct({url:o,fetch:t}){const s=o.searchParams.get("trip_id"),e=await(await t("/api/trip?trip_id="+s)).json(),l=await(await t("/api/position?trip_id="+s)).json(),n="L"+s.split("_")[0],_=await(await t("/api/route?route_id="+n)).json();return{trip:e,position:l,route:_}}const Tt=Object.freeze(Object.defineProperty({__proto__:null,load:ct},Symbol.toStringTag,{value:"Module"}));function U(o,t,s){const e=o.slice();return e[9]=t[s],e}function F(o){let t=o[5](o[9].departure_time)+"",s;return{c(){s=j(t)},l(e){s=q(e,t)},m(e,l){T(e,s,l)},p(e,l){l&1&&t!==(t=e[5](e[9].departure_time)+"")&&P(s,t)},d(e){e&&a(s)}}}function J(o){let t,s,e,l;function n(u,m){if(u[2]=="tram")return dt;if(u[2]=="night tram")return mt;if(u[2]=="bus")return ht;if(u[2]=="night bus")return pt;if(u[2]=="metro")return _t;if(u[2]=="ferry")return ft;if(u[2]=="train")return nt}let _=n(o),r=_&&_(o);function f(u,m){return u[1].delay>0?bt:vt}let D=f(o),k=D(o);return{c(){t=v("tr"),s=v("td"),r&&r.c(),e=C(),k.c(),l=C(),this.h()},l(u){t=b(u,"TR",{class:!0});var m=w(t);s=b(m,"TD",{class:!0});var d=w(s);r&&r.l(d),d.forEach(a),e=O(m),k.l(m),l=O(m),m.forEach(a),this.h()},h(){i(s,"class","first svelte-f2bixu"),i(t,"class","svelte-f2bixu")},m(u,m){T(u,t,m),y(t,s),r&&r.m(s,null),y(t,e),k.m(t,null),y(t,l)},p(u,m){_!==(_=n(u))&&(r&&r.d(1),r=_&&_(u),r&&(r.c(),r.m(s,null))),D===(D=f(u))&&k?k.p(u,m):(k.d(1),k=D(u),k&&(k.c(),k.m(t,l)))},d(u){u&&a(t),r&&r.d(),k.d()}}}function nt(o){let t,s;return{c(){t=v("img"),this.h()},l(e){t=b(e,"IMG",{class:!0,src:!0,alt:!0}),this.h()},h(){i(t,"class","icon svelte-f2bixu"),R(t.src,s="train.png")||i(t,"src",s),i(t,"alt","train")},m(e,l){T(e,t,l)},d(e){e&&a(t)}}}function ft(o){let t,s;return{c(){t=v("img"),this.h()},l(e){t=b(e,"IMG",{class:!0,src:!0,alt:!0}),this.h()},h(){i(t,"class","icon svelte-f2bixu"),R(t.src,s="kotva.png")||i(t,"src",s),i(t,"alt","ferry")},m(e,l){T(e,t,l)},d(e){e&&a(t)}}}function _t(o){let t,s;return{c(){t=v("img"),this.h()},l(e){t=b(e,"IMG",{class:!0,src:!0,alt:!0}),this.h()},h(){i(t,"class","icon svelte-f2bixu"),R(t.src,s="metro.png")||i(t,"src",s),i(t,"alt","metro")},m(e,l){T(e,t,l)},d(e){e&&a(t)}}}function pt(o){let t,s;return{c(){t=v("img"),this.h()},l(e){t=b(e,"IMG",{class:!0,src:!0,alt:!0}),this.h()},h(){i(t,"class","icon_night svelte-f2bixu"),R(t.src,s="bus.png")||i(t,"src",s),i(t,"alt","bus")},m(e,l){T(e,t,l)},d(e){e&&a(t)}}}function ht(o){let t,s;return{c(){t=v("img"),this.h()},l(e){t=b(e,"IMG",{class:!0,src:!0,alt:!0}),this.h()},h(){i(t,"class","icon svelte-f2bixu"),R(t.src,s="bus.png")||i(t,"src",s),i(t,"alt","bus")},m(e,l){T(e,t,l)},d(e){e&&a(t)}}}function mt(o){let t,s;return{c(){t=v("img"),this.h()},l(e){t=b(e,"IMG",{class:!0,src:!0,alt:!0}),this.h()},h(){i(t,"class","icon_night svelte-f2bixu"),R(t.src,s="tram.png")||i(t,"src",s),i(t,"alt","tram")},m(e,l){T(e,t,l)},d(e){e&&a(t)}}}function dt(o){let t,s;return{c(){t=v("img"),this.h()},l(e){t=b(e,"IMG",{class:!0,src:!0,alt:!0}),this.h()},h(){i(t,"class","icon svelte-f2bixu"),R(t.src,s="tram.png")||i(t,"src",s),i(t,"alt","tram")},m(e,l){T(e,t,l)},d(e){e&&a(t)}}}function vt(o){let t,s,e;return{c(){t=v("td"),s=v("td"),e=v("td"),this.h()},l(l){t=b(l,"TD",{class:!0}),w(t).forEach(a),s=b(l,"TD",{class:!0}),w(s).forEach(a),e=b(l,"TD",{class:!0}),w(e).forEach(a),this.h()},h(){i(t,"class","svelte-f2bixu"),i(s,"class","svelte-f2bixu"),i(e,"class","svelte-f2bixu")},m(l,n){T(l,t,n),T(l,s,n),T(l,e,n)},p:at,d(l){l&&a(t),l&&a(s),l&&a(e)}}}function bt(o){let t,s,e=(o[4]>0?o[4]+" m. ":"")+(o[3]>0?o[3]+" s. ":""),l,n,_;return{c(){t=v("td"),s=j("+"),l=j(e),n=v("td"),_=v("td"),this.h()},l(r){t=b(r,"TD",{class:!0,style:!0});var f=w(t);s=q(f,"+"),l=q(f,e),f.forEach(a),n=b(r,"TD",{class:!0}),w(n).forEach(a),_=b(r,"TD",{class:!0}),w(_).forEach(a),this.h()},h(){i(t,"class","stop svelte-f2bixu"),ot(t,"color","red"),i(n,"class","svelte-f2bixu"),i(_,"class","svelte-f2bixu")},m(r,f){T(r,t,f),y(t,s),y(t,l),T(r,n,f),T(r,_,f)},p(r,f){f&24&&e!==(e=(r[4]>0?r[4]+" m. ":"")+(r[3]>0?r[3]+" s. ":""))&&P(l,e)},d(r){r&&a(t),r&&a(n),r&&a(_)}}}function K(o,t){let s,e,l=t[9].stop_sequence+"",n,_,r,f,D=t[9].stop.properties.stop_name+"",k,u,m,d,A=t[5](t[9].arrival_time)+"",I,S,G,c,p,h=t[9].departure_time!=t[9].arrival_time&&F(t),E=t[1].last_stop.id==t[9].stop.properties.stop_id&&J(t);return{key:o,first:null,c(){s=v("tr"),e=v("td"),n=j(l),_=C(),r=v("td"),f=v("a"),k=j(D),m=C(),d=v("td"),I=j(A),S=C(),G=v("td"),h&&h.c(),c=C(),E&&E.c(),p=N(),this.h()},l(M){s=b(M,"TR",{class:!0});var g=w(s);e=b(g,"TD",{class:!0});var z=w(e);n=q(z,l),z.forEach(a),_=O(g),r=b(g,"TD",{class:!0});var B=w(r);f=b(B,"A",{href:!0,class:!0});var H=w(f);k=q(H,D),H.forEach(a),B.forEach(a),m=O(g),d=b(g,"TD",{class:!0});var L=w(d);I=q(L,A),L.forEach(a),S=O(g),G=b(g,"TD",{class:!0});var V=w(G);h&&h.l(V),V.forEach(a),g.forEach(a),c=O(M),E&&E.l(M),p=N(),this.h()},h(){i(e,"class","first svelte-f2bixu"),i(f,"href",u="/single?ids="+t[9].stop.properties.stop_id),i(f,"class","svelte-f2bixu"),i(r,"class","svelte-f2bixu"),i(d,"class","svelte-f2bixu"),i(G,"class","svelte-f2bixu"),i(s,"class","svelte-f2bixu"),this.first=s},m(M,g){T(M,s,g),y(s,e),y(e,n),y(s,_),y(s,r),y(r,f),y(f,k),y(s,m),y(s,d),y(d,I),y(s,S),y(s,G),h&&h.m(G,null),T(M,c,g),E&&E.m(M,g),T(M,p,g)},p(M,g){t=M,g&1&&l!==(l=t[9].stop_sequence+"")&&P(n,l),g&1&&D!==(D=t[9].stop.properties.stop_name+"")&&P(k,D),g&1&&u!==(u="/single?ids="+t[9].stop.properties.stop_id)&&i(f,"href",u),g&1&&A!==(A=t[5](t[9].arrival_time)+"")&&P(I,A),t[9].departure_time!=t[9].arrival_time?h?h.p(t,g):(h=F(t),h.c(),h.m(G,null)):h&&(h.d(1),h=null),t[1].last_stop.id==t[9].stop.properties.stop_id?E?E.p(t,g):(E=J(t),E.c(),E.m(p.parentNode,p)):E&&(E.d(1),E=null)},d(M){M&&a(s),h&&h.d(),M&&a(c),E&&E.d(M),M&&a(p)}}}function gt(o){let t,s,e,l,n,_=o[0].route.route_short_name+"",r,f,D=o[0].trip.trip_headsign+"",k,u,m,d=[],A=new Map,I;s=new ut({});let S=o[0].trip.stop_times;const G=c=>c[9].stop.properties.stop_id;for(let c=0;c<S.length;c+=1){let p=U(o,S,c),h=G(p);A.set(h,d[c]=K(h,p))}return{c(){t=v("div"),Y(s.$$.fragment),e=C(),l=v("h1"),n=v("a"),r=j(_),f=j(" směr "),k=j(D),u=C(),m=v("table");for(let c=0;c<d.length;c+=1)d[c].c();this.h()},l(c){t=b(c,"DIV",{class:!0});var p=w(t);Z(s.$$.fragment,p),e=O(p),l=b(p,"H1",{class:!0});var h=w(l);n=b(h,"A",{href:!0,class:!0});var E=w(n);r=q(E,_),f=q(E," směr "),k=q(E,D),E.forEach(a),h.forEach(a),p.forEach(a),u=O(c),m=b(c,"TABLE",{class:!0});var M=w(m);for(let g=0;g<d.length;g+=1)d[g].l(M);M.forEach(a),this.h()},h(){i(n,"href","/"),i(n,"class","svelte-f2bixu"),i(l,"class","svelte-f2bixu"),i(t,"class","header svelte-f2bixu"),i(m,"class","stop svelte-f2bixu")},m(c,p){T(c,t,p),$(s,t,null),y(t,e),y(t,l),y(l,n),y(n,r),y(n,f),y(n,k),T(c,u,p),T(c,m,p);for(let h=0;h<d.length;h+=1)d[h]&&d[h].m(m,null);I=!0},p(c,[p]){(!I||p&1)&&_!==(_=c[0].route.route_short_name+"")&&P(r,_),(!I||p&1)&&D!==(D=c[0].trip.trip_headsign+"")&&P(k,D),p&63&&(S=c[0].trip.stop_times,d=x(d,p,G,1,c,S,A,m,rt,K,null,U))},i(c){I||(tt(s.$$.fragment,c),I=!0)},o(c){et(s.$$.fragment,c),I=!1},d(c){c&&a(t),st(s),c&&a(u),c&&a(m);for(let p=0;p<d.length;p+=1)d[p].d()}}}function kt(o,t,s){let e,l,n;const _=["tram","metro","train","bus","ferry","funicular","trolleybus"];let{data:r}=t,f=r.position,D=r.trip.trip_id;lt(()=>{setInterval(async()=>{s(1,f=await(await fetch("/api/position/?trip_id="+D)).json())},5e3)});function k(u){let m=u.split(":")[0],d=it(m);return d=d%24,d+":"+u.split(":")[1]+":"+u.split(":")[2]}return console.log(r),o.$$set=u=>{"data"in u&&s(0,r=u.data)},o.$$.update=()=>{o.$$.dirty&2&&s(4,e=Math.floor(f.delay/60)),o.$$.dirty&2&&s(3,l=f.delay%60),o.$$.dirty&1&&s(2,n=(r.route.is_night?"night ":"")+_[r.route.route_type])},[r,f,n,l,e,k]}class Dt extends Q{constructor(t){super(),W(this,t,kt,gt,X,{data:0})}}export{Dt as component,Tt as universal};
